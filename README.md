# Тестирование шахматной программы на C#

## Запуск

В корневой директории:
```sh
dotnet restore
dotnet test
```

## Выбор фигур
Для реализации были выбраны фигуры **Пешка** и **Ладья**, поскольку они демонстрируют различные аспекты шахматной логики:
- **Пешка** - сложные правила движения, специальные ходы (взятие на проходе, превращение)
- **Ладья** - простое линейное движение, но с проверкой препятствий на пути

## Архитектура решения

### Основные классы и интерфейсы:
1. **IChessman** - интерфейс для всех шахматных фигур
2. **ChessField** - представление поля шахматной доски
3. **ChessMove** - представление шахматного хода с нотацией
4. **ChessBoard** - шахматная доска и логика игры
5. **Chessman** - базовый абстрактный класс фигуры
6. **Pawn** - реализация пешки
7. **Rook** - реализация ладьи

### Перечисления:
- **EChessmanType** - типы шахматных фигур
- **ESide** - стороны (белые/черные)

## Логика построения тестов

### 1. Тесты для пешки (Pawn)

#### Позитивные тесты:
- **Pawn_OneStepForward_ShouldBeValid**: Проверяет базовое движение пешки на одно поле вперед
- **Pawn_TwoStepsFromStart_ShouldBeValid**: Проверяет двойной ход пешки с начальной позиции
- **Pawn_DiagonalCapture_ShouldBeValid**: Проверяет взятие по диагонали
- **Pawn_EnPassantCapture_ShouldBeValid**: Проверяет сложное правило взятия на проходе
- **Pawn_PromotionToQueen_ShouldBeValid**: Проверяет превращение пешки при достижении последней горизонтали

#### Негативные тесты:
- **Pawn_TwoStepsAfterMoving_ShouldThrowException**: Пешка не может ходить на два поля после первого хода
- **Pawn_DiagonalMoveWithoutCapture_ShouldThrowException**: Пешка не может ходить по диагонали без взятия
- **Pawn_ForwardMoveBlocked_ShouldThrowException**: Пешка не может ходить, если путь заблокирован
- **Pawn_BackwardMove_ShouldThrowException**: Пешка не может ходить назад

### 2. Тесты для ладьи (Rook)

#### Позитивные тесты:
- **Rook_HorizontalMove_ShouldBeValid**: Проверяет горизонтальное движение ладьи
- **Rook_VerticalMove_ShouldBeValid**: Проверяет вертикальное движение ладьи
- **Rook_CaptureEnemyPiece_ShouldBeValid**: Проверяет взятие вражеской фигуры
- **Rook_LongVerticalMove_ShouldBeValid**: Проверяет длинное вертикальное движение

#### Негативные тесты:
- **Rook_DiagonalMove_ShouldThrowException**: Ладья не может ходить по диагонали
- **Rook_MoveBlockedByOwnPiece_ShouldThrowException**: Ладья не может перепрыгивать свои фигуры
- **Rook_MoveBlockedByEnemyPiece_ShouldThrowException**: Ладья не может перепрыгивать вражеские фигуры
- **Rook_CaptureOwnPiece_ShouldThrowException**: Ладья не может взять свою фигуру

### 3. Тесты для шахматной нотации (ChessMove)

- **ChessMove_SimpleMove_ShouldReturnCorrectNotation**: Проверяет базовую нотацию хода
- **ChessMove_CaptureMove_ShouldReturnCorrectNotation**: Проверяет нотацию взятия
- **ChessMove_PawnPromotion_ShouldReturnCorrectNotation**: Проверяет нотацию превращения пешки

### 4. Тесты валидации (ChessField)

- **ChessField_InvalidRow_ShouldThrowException**: Проверяет валидацию строки (row) поля
- **ChessField_InvalidColumn_ShouldThrowException**: Проверяет валидацию колонки (column) поля
- **ChessField_ValidCoordinates_ShouldNotThrow**: Проверяет, что корректные координаты не вызывают исключения

## Особенности реализации

### 1. Test-Driven Development подход:
1. Сначала писались тесты для каждого сценария
2. Затем создавался минимальный код для прохождения тестов
3. Код рефакторился для улучшения структуры

### 2. Обработка сложных правил:
- **Взятие на проходе**: Реализована полная логика с проверкой последнего хода
- **Превращение пешки**: Автоматическое превращение в ферзя при достижении последней горизонтали
- **Проверка пути**: Для ладьи реализована проверка свободности пути

### 3. Шахматная нотация:
Метод `AsString()` класса `ChessMove` генерирует корректную шахматную нотацию:
- Простые ходы: "e4", "Ra8"
- Взятия: "exd5", "Rxh1"
- Специальные ходы: "e8=Q" (превращение), "exd6 e.p." (взятие на проходе)

## Результаты выполнения тестов

### Успешные тесты:
✅ Все 17 тестов для пешки прошли успешно  
✅ Все 8 тестов для ладьи прошли успешно  
✅ Все 3 теста для шахматной нотации прошли успешно  
✅ Все 3 теста валидации прошли успешно
